import sys

magic_numbers = {
    "pdf": bytes([0x25, 0x50, 0x44, 0x46]),
    "txt": bytes([0x54, 0x6f,0x74, 0x61, 0x6c, 0x20, 0x74, 0x69]),
    "csv": bytes([0x30, 0x2c, 0x46, 0x69, 0x72, 0x73, 0x74, 0x20]),
    "png": bytes([0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A]),
    "xlsx": bytes([0x50, 0x4b, 0x03, 0x04, 0x14, 0x00, 0x08, 0x08]),
    "jpg": bytes([0xff, 0xd8, 0xff, 0xe0, 0x00 ,0x10, 0x4a, 0x46]),
    "docx": bytes([0x50, 0x4b, 0x03, 0x04, 0x14, 0x00, 0x00, 0x00]),
    "wav": bytes([0x52, 0x49,0x46,0x46 ,0xa6, 0xd3 ,0x1b, 0x00]),
    "mp3": bytes([0x49, 0x44, 0x33]),
    "gif": bytes([0x47, 0x49, 0x46, 0x38]),
    "bmp": bytes([0x42, 0x4d]),
    "tiff": bytes([0x49, 0x49, 0x2A, 0x00]),
    "ico": bytes([0x00, 0x00, 0x01, 0x00]),
    "icns": bytes([0x69, 0x63, 0x6e, 0x73]),
    "webp": bytes([0x57, 0x45, 0x42, 0x50])
}


''''GIF':'image/gif', 
    'BMP':'image/bmp', 
    'TIFF':'image/tiff', 
    'ICO':'image/vnd.microsoft.icon', 
    'ICNS':'image/x-icns',
    'WEBP':'image/webp', 
    'TGA':'image/targa', '''

def check_extension(file_path, ext):
    with open(file_path, 'rb') as f:
        file_head = f.read()
        if ext=='txt' or ext=='csv' or ext=='tsv' or ext=='html':
            return True
        if file_head.startswith(magic_numbers[ext]):
            return True
        return False

x = check_extension("Test Data/ExcelData/file_example_XLSX_10.xlsx", "xlsx")
print(x)